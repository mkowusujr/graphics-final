<html>
<head>
    <title>CSCI-510: Tessellation</title>
    <link rel="stylesheet" href="tess.css">
    <!-- vertex Shader -->
    <script id="vertex-shader" type="x-shader/x-vertex">
        #version 300 es
        in vec4 aVertexPosition;
        in vec3 bary;
        uniform vec3 theta;
        
        out vec3 vbc;

        void main()
        {
            // Compute the sines and cosines of each rotation
            // about each axis
            vec3 angles = radians( theta );
            vec3 c = cos( angles );
            vec3 s = sin( angles );

            // rotation matrices
            mat4 rx = mat4 ( 1.0,  0.0,  0.0,  0.0,
                             0.0,  c.x,  s.x,  0.0,
                             0.0, -s.x,  c.x,  0.0,
                             0.0,  0.0,  0.0,  1.0 );

            mat4 ry = mat4 ( c.y,  0.0, -s.y,  0.0,
                             0.0,  1.0,  0.0,  0.0,
                             s.y,  0.0,  c.y,  0.0,
                             0.0,  0.0,  0.0,  1.0 );

            mat4 rz = mat4 ( c.z,  s.z,  0.0,  0.0,
                            -s.z,  c.z,  0.0,  0.0,
                             0.0,  0.0,  1.0,  0.0,
                             0.0,  0.0,  0.0,  1.0 );

            gl_Position = rz * ry * rx * aVertexPosition;
            vbc = bary;
        }
    </script>

     <!-- fragment Shader -->
     <script id="fragment-shader" type="x-shader/x-fragment">
         #version 300 es
         precision mediump float;
         
         in vec3 vbc;

         // Color that is the result of this shader
         out vec4 fragColor;

         void main(void) {
             
             fragColor = vec4 (0.5, 0.5, 0.5, 1.0 );
           // if on the edge, draw black, otherwsie, draw grey
           if (vbc.x < 0.01 || vbc.y < 0.01 || vbc.z < 0.01) {
             fragColor = vec4 (1.0, 1.0, 1.0, 1.0);
           }
         }

     </script>
     
     <!-- include the shape creation functions -->
    <script type="text/javascript" src="./cgIShape.js"></script>
    
    <!-- include the main tesselation functions -->
    <script type="text/javascript" src="./tessMain.js"></script>
    
    <!-- keyboard functions -->
    <script type="text/javascript">
    
    function gotKey (event) {
      var key = event.key;

      //todo delete this at some point
      curShape = SPHERE;

      let angleIndex = 0;
      let angleIncVal = 0;
      switch (key){
        // Increment rotation
        case 'i':
          angleIndex = 0;
          angleIncVal = -angleInc;
          break;
        case 'k':
          angleIndex = 0;
          angleIncVal = angleInc;
          break;
        case 'j':
          angleIndex = 1;
          angleIncVal = -angleInc;
          break;
        case 'l':
          angleIndex = 1;
          angleIncVal = angleInc;
          break;
        case 'u':
          angleIndex = 2;
          angleIncVal = -angleInc;
          break;
        case 'o':
          angleIndex = 2;
          angleIncVal = angleInc;
          break;
        // Increment position
        case 'a':
          //todo add camera movement
          break;
        case 'd':
          //todo add camera movement
          break;
        case 'w':
          //todo add camera movement
          break;
        case 's':
          //todo add camera movement
          break;
        case 'q':
          //todo add camera movement
          break;
        case 'e':
          //todo add camera movement
          break;
        // Reset position and angle
        case 'r':
          angles[0] = anglesReset[0];
          angles[1] = anglesReset[1];
          angles[2] = anglesReset[2];
          //todo position reset
          break;
      }
      angles[angleIndex] += angleIncVal;
        
      // Create a new shape and do a redo a draw
      createNewShape();
      draw();
    }
    
    </script>

  <script type="text/javascript">
    // Call init once the webpage has loaded
    window.onload = init;
  </script>
</head>

<body>
  <canvas id="webgl-canvas">
    Your browser does not support the HTML5 canvas element.
  </canvas>    
  <table border="1">
    <tbody>
      <tr>
        <td>j,k,i,l,u,o</td>
        <td>Rotate cam rev</td>
      </tr>
      <tr>
        <td>r,R</td>
        <td>Reset pos & rot</td>
      </tr>
      <tr>
        <td>a,s,w,d,q,e</td>
        <td>Move cam</td>
      </tr>
    </tbody>
  </table>
</body>
</html>

